services:
  - type: web
    name: devchat-frontend
    env: node
    buildCommand: "cd frontend && NODE_OPTIONS='--max-old-space-size=256' npm ci && NODE_OPTIONS='--max-old-space-size=256' npm run build"
    startCommand: "cd frontend && npm install -g serve && serve -s build -l 3000"
    envVars:
      - key: NODE_OPTIONS
        value: "--max-old-space-size=256"
      - key: CI
        value: "true"
    
  - type: web
    name: devchat-backend
    env: node
    buildCommand: "cd backend && npm ci"
    startCommand: "cd backend && npm start"
    envVars:
      - key: MONGO_URI
        value: mongodb+srv://user:pass@cluster.mongodb.net/devchat_pro
